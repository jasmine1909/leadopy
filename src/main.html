<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
        integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
        <link href="/dist/output.css" rel="stylesheet">
        <script src="https://cdn.tailwindcss.com"></script>


    <title>Document</title>
</head>
<style>
    select {
  background-color: #F3F4F6;
  border: 10px solid #F3F4F6;
  border-width: 8px 8px 8px 20px;
  border-radius: 30px;
    }
    .hide{
        display: none;
    }
    .info {
        display: none;
    }

    .visible {
        display: inline-block;
    }
    .table2{
        font-size: 30px;color:blue;
    }
    .fa-circle-arrow-up,  .fa-circle-arrow-down{
        background:-moz-linear-gradient(309deg, #E88751 0%, #C93F74 100%); 
    background: -webkit-linear-gradient(309deg, #E88751 0%, #C93F74 100%); 
    background: linear-gradient(to left,#E88751 0%,#C93F74 100%);
    -webkit-background-clip: text;
    -moz-background-clip: text;
    background-clip: text;
   -webkit-text-fill-color:transparent;
    }
    .box{
  border: double 6px transparent;
  border-radius: 30px;
  background-image: linear-gradient(white, white), 
  linear-gradient(309deg, #C93F74 0%,#E88751 100%);
  background-origin: border-box;
  background-clip: content-box, border-box;
  }



</style>

<body text="#1a1a1a">

 
  <!-- Navbar -->
  <nav class="relative flex flex-wrap items-center justify-between px-6 py-3 mb-3">
    <div class="ml-6 font-medium text-2xl"> <img src="./img/logo1.png" class="w-32" />  </div>
    <ul class="flex m-3">
        <li class="mr-3  text-sm font-semibold bg-gray-100 px-3.5 py-2 rounded-lg">
            <a><i class="fa-sharp fa-solid fa-house"></i> Home</a>
          </li>
  
      <li class="mr-3  text-sm font-semibold bg-gray-100 px-3.5 py-2 rounded-lg">
        <a><i class="fa-solid fa-file-arrow-down"></i> Archive</a>
      </li>
      <li class="mr-3  text-sm font-semibold bg-gray-100 px-3.5 py-2 rounded-lg">
        <a><i class="fa-solid fa-gear"></i> Settings</a>
      </li>
      <li class="mr-3  text-sm font-semibold bg-gray-100 px-3.5 py-2 rounded-lg">
        <a><i class="fa-solid fa-circle-question"></i> Help</a>
      </li>

    </ul>
  </nav>

   <!-- Header -->
   <div class="relative md:pt-8 pb-8 pt-12">
    <div class="px-4 md:px-10 mx-auto w-full">
        <div>
            <!-- Card stats -->
            <div class="flex flex-wrap">
                <!--item-->
                <div class="w-full lg:w-6/12 xl:w-3/12 px-4">
                    <div
                        class="box relative flex flex-col min-w-0 break-words bg-stone-100 rounded mb-6 xl:mb-0 shadow-lg">
                        <div class="flex-auto p-8">
                            <div class="flex flex-wrap">

                                <div class="relative w-full text-center p-8 max-w-full flex-grow flex-1">
                                    <h5 class=" uppercase font-bold pb-2 text-xs">
                                        Total Entries
                                    </h5>
                                    <span class="total-entries font-semibold text-4xl ">
                                        5,006
                                    </span>
                                </div>


                            </div>

                        </div>
                    </div>
                </div>
                <!--item-->

                <!--item-->
                <div class="w-full lg:w-6/12 xl:w-3/12 px-4">
                    <div
                        class="box relative flex flex-col min-w-0 break-words bg-stone-100 rounded mb-6 xl:mb-0 shadow-lg">
                        <div class="flex-auto p-2">
                            <div class="flex flex-wrap">

                                <div class="relative w-full text-center p-8 max-w-full flex-grow flex-1">
                                    <h3 class=" uppercase font-bold pb-2 text-xs">
                                        30 days
                                    </h3>
                                    <span class="font-semibold text-4xl total30days ">
                                        156
                                    </span>
                                    <h1 class=" mt-1 text-xs">Recent Entries</h1>
                                    <div class="mt-1">
                                        <p><span class="pr-2 text-s" id="icons1"></span><span
                                                class="ptchangeMonth"></span>%</p>

                                    </div>
                                </div>


                            </div>

                        </div>
                    </div>
                </div>
                <!--item-->


                <!--item-->
                <div class="w-full lg:w-6/12 xl:w-3/12 px-4">
                    <div
                        class="box relative flex flex-col min-w-0 break-words bg-stone-100 rounded mb-6 xl:mb-0 shadow-lg">
                        <div class="flex-auto p-2">
                            <div class="flex flex-wrap">

                                <div class="relative w-full text-center p-8 max-w-full flex-grow flex-1">
                                    <h3 class=" uppercase font-bold pb-2 text-xs">
                                        90 days
                                    </h3>
                                    <span class="font-semibold text-4xl total90days ">
                                        156
                                    </span>
                                    <h1 class=" mt-1 text-xs">Recent Entries</h1>
                                    <div class="mt-1">
                                        <p><span class="icons-change pr-2 text-s" id="icons2"></span><span class="pt90Days"></span>%</p>

                                    </div>
                                </div>


                            </div>

                        </div>
                    </div>
                </div>
                <!--item-->


                <!--item-->
                <div class="w-full lg:w-6/12 xl:w-3/12 px-4">
                    <div
                        class="box relative flex flex-col min-w-0 break-words bg-stone-100 rounded mb-6 xl:mb-0 shadow-lg">
                        <div class="flex-auto p-2">
                            <div class="flex flex-wrap">

                                <div class="relative w-full text-center p-8 max-w-full flex-grow flex-1">
                                    <h3 class=" uppercase font-bold pb-2 text-xs ">
                                        365 days
                                    </h3>
                                    <span class="font-semibold text-4xl lastyear ">
                                        1,365
                                    </span>
                                    <h1 class=" mt-1 text-xs">Recent Entries</h1>
                                    <div class="mt-1">
                                        <p><span class="pr-2 text-s" id="icons3"></span><span class="ptYears"></span>%</p>

                                    </div>
                                </div>


                            </div>

                        </div>
                    </div>
                </div>
                <!--item-->
            </div>
        </div>
    </div>
    <div class="border-t-2 my-12">

         


        <div
        class="container mx-auto px-6 pt-6 flex justify-between items-center text-sm font-medium leading-none text-gray-600       cursor-pointer rounded">
        <div id="search" class=" inline-block relative w-3/4 mr-3 ">
          <input type="" name="" id="myInput" onkeyup="filterSearch()"
            class="leading-snug   block w-full appearance-none text-sm  py-2   px-4 pl-8 rounded-lg border-none outline-none focus:border-gray-500 bg-gray-100 placeholder-gray-500 "
            placeholder="Search Name..." />

          <div class="pointer-events-none absolute  inset-y-0 left-0 flex items-center px-3.5 text-gray-300">

            <svg class="fill-current h-3 w-3" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 511.999 511.999">
              <path
                d="M508.874 478.708L360.142 329.976c28.21-34.827 45.191-79.103 45.191-127.309C405.333 90.917 314.416 0 202.666 0S0 90.917 0 202.667s90.917 202.667 202.667 202.667c48.206 0 92.482-16.982 127.309-45.191l148.732 148.732c4.167 4.165 10.919 4.165 15.086 0l15.081-15.082c4.165-4.166 4.165-10.92-.001-15.085zM202.667 362.667c-88.229 0-160-71.771-160-160s71.771-160 160-160 160 71.771 160 160-71.771 160-160 160z" />
            </svg>
          </div>
        </div>
        <div class="flex justify-between items-center ">
          
          <select id="listDropdown" class=" outline-none rounded-lg cursor-pointer " oninput="filterTable()">
            <option> All Forms
            </option>
            <option>Contact Us
            </option>
            <option>Ad Campaign - Hardwood Flooring</option>
            <option>Apply for Financing
            </option>
            <option>Ad Campaign - Remarketing - All Services</option>

          </select>
        </div>

      </div>

        </div>



        <!---Show information -->
        <!--table-->
        <section class=" container mx-auto px-6 pb-6 font-mono 
        ">
            <div class="w-full mb-8 overflow-hidden rounded-lg shadow-lg">
                <div class="w-full overflow-x-auto table">
                    <table  id="myTable" class=" w-full content-table">
                        <thead class="bg-gradient-to-r from-yellow-600 via-orange-600 to-pink-600">
                            <tr class="mytable text-xs font-semibold  text-left text-white " data-user-cards-container>
                                <th class="px-4  py-3"></th>
                                <th class="px-4  py-3">Name</th>
                                <th class="px-4  py-3">Entries Date</th>
                                <th class="px-4  py-3">Email</th>
                                <th class="px-4   py-3">Phone</th>
                                <th class="px-4  py-3">Form Name</th>
                                <th class="px-4  py-3">Qualified</th>
                                <th class="px-4  py-3">Note</th>
                               
                                <th class="px-4  border-l-2 py-3 hide">Flooring</th>
                                <th class="px-4  border-l-2 py-3 hide">Cabinetry</th>
                                <th class="px-4  border-l-2 py-3 hide">Countertop</th>
                                <th class="px-4  border-l-2 py-3 hide">Describe Project</th>
                                <th class="px-4  border-l-2 py-3 hide">Subject</th>
                                <th class="px-4  border-l-2 py-3 hide">Message</th>

                               
                                
                                <th></th>




                            </tr>
                        </thead>

                        <tbody id="data" class="text-xs text-stone-400">

                            <!-- <tr>
                                        <td class="px-4 py-3 border " data-header>
                                         




                                        </td>
                                        <td class="px-4 py-3 font-semibold border">1</td>
                                        <td class="px-4 py-3  border">
                                         

                                        </td>
                                        <td class="px-4 py-3  border"></td>
                                        <td class="px-4 py-3  border">contact </td>
                                    </tr> -->




                        </tbody>
                    </table>
                    <div class="px-5 py-5 bg-white border-t flex flex-col xs:flex-row items-center xs:justify-between          ">
                        <div class="inline-flex mt-2 xs:mt-0">
                          <button id="prevButton"
                            class="text-sm     shadow shadow-pink-300/80 hover:shadow-pink-800  font-semibold py-2 px-4 rounded-l">
                            <i class="fa-solid fa-chevrons-left"></i>
                            Prev
                          </button>
                          <button id="nextButton"
                            class="text-sm shadow shadow-pink-300/80 hover:shadow-pink-800  font-semibold py-2 px-4 rounded-r">
                            Next
                            <i class="fa-solid fa-chevrons-right"></i>
                          </button>
                        </div>
                      </div>
                </div>
            </div>
        </section>


</body>


<script>




    //page 
    let clientData = []
    let pageSize = 60;


    let currentPage = 1
    async function renderTable(page = 1) {
        await getData()
        if (page == 1) {
            prevButton.style.visibility = "hidden"
        } else {
            prevButton.style.visibility = "visible"

        }
        if (page == numberOfPages()) {
            nextButton.style.visibility = "hidden"
        } else {
            nextButton.style.visibility = "visible"
        }
        let temp = ""

        ///create HTMl table 




        clientData.filter((row, index) => {
            let start = (currentPage - 1) * pageSize
            let end = currentPage * pageSize

            if (index >= start && index < end) return true;
        })      .forEach((item) => {
        

        // TODO : I call my function infosRowSelected with more arguments
        temp += `
            <tr class="active:bg-gray-100 rounded shadow hover:shadow-lg outline-none focus:outline-none mr-1 mb-1 transition-all duration-150 text-black" 
         >
         <td class='px-4 py-3 font-medium border'><input type="checkbox" ></td>
            <td class='px-4 py-3 border'> ${item.Name}</td>
            <td class='px-4 py-3 border'>${item
            .Date
            .slice(0, 10)}</td>
            <td class='px-4 py-3 text-xs border'>${item
            .Email}</td>
            <td class='px-4 py-3 text-xs borderr'>${item
            .Phone}</td>
            <td class='px-4 py-3 text-/-*xs border'>${item['Form Title']}</td>
            <td class='px-4 py-3 text-xs border'  ><span class="flex justify-around items-center" ><i class="fa-solid fa-thumbs-up text-gray-500"></i><i class="fa-solid fa-thumbs-down text-gray-500"></i></span></td>
            <td class='px-4 py-3text-xs border'  >

<button class="myBtn"><i class="fa-solid fa-pen-to-square"></i></button>

</td>
        
            <td class='px-4 py-3 text-ms font-semibold border hide'>${item
            .Flooring}</td>
            <td class='px-4 py-3 text-ms font-semibold border hide'>${item
            .Cabinetry}</td>
            <td class='px-4 py-3 text-ms font-semibold border hide'>${item
            .Countertop}</td>
            <td class='px-4 py-3 text-ms font-semibold border hide'>${item
            .Describe}</td>
            <td class='px-4 py-3 text-ms font-semibold border hide'>${item
            .Subject}</td>
            <td class='px-4 py-3 text-ms font-semibold border hide'>${item
            .Message}</td>
          
            </tr>`




      })

        document.getElementById("data").innerHTML = temp



    }

    renderTable()

 



 
    ///click show detail
    function showRowDetails(event) {
            var w = window.open();
            w.document.body.innerHTML = "<table class='table2' border='1' >" + event.target.parentNode.innerHTML +"</table>";

            w.document.body.style.color= "gray" 
            w.document.body.childrenNode.style.padding ="60px"
          
            


      
            var tbl = document.getElementById("myTable");
            var i;
            var j;
            for (i = 0; i < tbl.rows.length; i++)
                for (j = 0; j < tbl.rows[i].cells.length; j++)
              
                    tbl.rows[i].cells[j].style.visibility = "visible";
        }
      
    function myFunction() {
            const myDIVs = document.getElementsByClassName("myDIVs");
            for (let i = 0; i < myDivs.length; i++) {
                if (myDivs[i].style.display === "none") {
                    myDivs[i].style.display = "block";
               
                    document.getElementsByClassName("hide").style.display="block"
                } else {
                    myDivs[i].style.display = "none";
                }
            }
        } 



      

    //pagination






    function previosPage() {
        if (currentPage > 1)
            currentPage--;
        renderTable(currentPage)
    }
    function nextPage() {
        if ((currentPage * pageSize) < clientData.length)
            currentPage++;
        renderTable(currentPage)
    }
    function numberOfPages() {
        return Math.ceil(clientData.length / pageSize)
    }

    document.getElementById("prevButton").addEventListener("click", previosPage, false)
    document.getElementById("nextButton").addEventListener("click", nextPage, false)
    async function getData() {
      
        const response = await fetch("https://script.google.com/macros/s/AKfycbwHKludSDbBwmY4gd_Jz8AZedUj8OcbFnO3niL--J22GK2Lbc1jSJazzl6X4Dgxhg9U/exec")

        console.log(response)
        const data = await response.json()

        //total entries
        const total = data.length;
        document.querySelector(".total-entries").innerText = total

        //last 30 days

        clientData = data.reverse()

        const currentDate = new Date();
        const currentDateTime = currentDate.getTime();
        const last30DaysDate = new Date(currentDate.setDate(currentDate.getDate() - 30));
        const last30DaysDateTime = last30DaysDate.getTime();

        const last30DaysList = data.filter(x => {
            const elementDateTime = new Date(x.Date).getTime();
            if (elementDateTime <= currentDateTime && elementDateTime > last30DaysDateTime) {
                return true;
            }
            return false
        }).sort((a, b) => {
            return new Date(b.Date) - new Date(a.Date);
        });



        const totalLast30Day = last30DaysList.length
        document.querySelector(".total30days").innerText = totalLast30Day
        //last 60 days

        const currentDate2 = new Date();
        const currentDateTime2 = currentDate2.getTime();

       
        const last60DaysDate = new Date(currentDate2.setDate(currentDate2.getDate() - 60));
        const last60DaysDateTime = last60DaysDate.getTime();


        const last60DaysList = data.filter(x => {
            const elementDateTime = new Date(x.Date).getTime();
            if (elementDateTime <= currentDateTime2 && elementDateTime > last60DaysDateTime) {
                return true;
            }
            return false
        })
        console.log(last60DaysList)


        const totalLast60Day = last60DaysList.length
   
        const total2MonthAgo = totalLast60Day - totalLast30Day
        console.log(total2MonthAgo)

 
        const getPercentageIncrease = (((totalLast30Day - total2MonthAgo) / total2MonthAgo) * 100).toFixed(2);

console.log(getPercentageIncrease)


        document.querySelector(".ptchangeMonth").innerText = getPercentageIncrease
        let increase1;
if( getPercentageIncrease > 0){
   increase1="<i class='fa-solid fa-circle-arrow-up'></i>"
}else{
   increase1 ="<i class='fa-solid fa-circle-arrow-down'></i>"
}
 document.getElementById("icons1").innerHTML = increase1;





     // get last 90 days
     const currentDate1 = new Date();
        const currentDateTime1 = currentDate1.getTime();

        const last90DaysDate = new Date(currentDate1.setDate(currentDate1.getDate() - 90));
        const last90DaysDateTime = last90DaysDate.getTime();

        const last90DaysList = data.filter(x => {
            const elementDateTime = new Date(x.Date).getTime();
            if (elementDateTime <= currentDateTime1 && elementDateTime > last90DaysDateTime) {
                return true;
            }
            return false
        }).sort((a, b) => {
            return new Date(b.Date) - new Date(a.Date);
        });
console.log(last90DaysList)

        const totalLast90Day = last90DaysList.length
        document.querySelector(".total90days").innerText = totalLast90Day

     
        const currentDate3 = new Date();
        const currentDateTime3 = currentDate3.getTime();


        const last180DaysDate = new Date(currentDate3.setDate(currentDate3.getDate() - 180));
        const last180DaysDateTime = last180DaysDate.getTime();

        const last180DaysList = data.filter(x => {
            const elementDateTime = new Date(x.Date).getTime();
            if (elementDateTime <= currentDateTime3 && elementDateTime > last180DaysDateTime) {
                return true;
            }
            return false
        }).sort((a, b) => {
            return new Date(b.Date) - new Date(a.Date);
        });


        const totalLast180Day = last180DaysList.length
        console.log(totalLast180Day)
        const totalLastQ = totalLast180Day - totalLast90Day
        console.log(totalLastQ)

      
        const getIncrease90Days = (((totalLast90Day - totalLastQ) / totalLastQ) * 100).toFixed(2);

        document.querySelector(".pt90Days").innerText = getIncrease90Days
        let increase2;
if( getIncrease90Days > 0){
   increase2="<i class='fa-solid fa-circle-arrow-up'></i>"
}else{
   increase2 ="<i class='fa-solid fa-circle-arrow-down'></i>"
}
 document.getElementById("icons2").innerHTML = increase2;





        //get last 365 days
        const currentDate4 = new Date();
        const currentDateTime4 = currentDate4.getTime();

       
        const last365DaysDate = new Date(currentDate4.setDate(currentDate4.getDate() - 365));
        const last365DaysDateTime = last365DaysDate.getTime();

        const last365DaysList = data.filter(x => {
            const elementDateTime = new Date(x.Date).getTime();
            if (elementDateTime <= currentDateTime4 && elementDateTime > last365DaysDateTime) {
                return true;
            }
            return false
        }).sort((a, b) => {
            return new Date(b.Date) - new Date(a.Date);
        });
        const totalLast365Day = last365DaysList.length
        document.querySelector(".lastyear").innerText = totalLast365Day


 const currentDate5 = new Date();
        const currentDateTime5 = currentDate3.getTime();


        const last730DaysDate = new Date(currentDate5.setDate(currentDate5.getDate() - 180));
        const last730DaysDateTime = last730DaysDate.getTime();

        const last730DaysList = data.filter(x => {
            const elementDateTime = new Date(x.Date).getTime();
            if (elementDateTime <= currentDateTime5 && elementDateTime > last180DaysDateTime) {
                return true;
            }
            return false
        }).sort((a, b) => {
            return new Date(b.Date) - new Date(a.Date);
        });


        const totalLast730Day = last730DaysList.length
        console.log(totalLast730Day)
        const totalLastY = totalLast730Day - totalLast365Day
        console.log(totalLastY)

       
        const getIncreaseYear = (((totalLast365Day - totalLastY) / totalLastY) * 100).toFixed(2);
console.log(getIncreaseYear)
let greeting;
if( getIncreaseYear > 0){
    greeting="<i class='fa-solid fa-circle-arrow-up'></i>"
}else{
    greeting ="<i class='fa-solid fa-circle-arrow-down'></i>"
}
 document.getElementById("icons3").innerHTML = greeting;



        document.querySelector(".ptYears").innerText = getIncreaseYear



        console.log(clientData)
    }
    getData()


    //fitler
    function filterSearch() {
  var input, filter, table, tr, td, i, txtValue;
  input = document.getElementById("myInput");
  filter = input.value.toUpperCase();
  table = document.getElementById("myTable");
  tr = table.getElementsByTagName("tr");
  for (i = 0; i < tr.length; i++) {
    td = tr[i].getElementsByTagName("td")[1];
    if (td) {
      txtValue = td.textContent || td.innerText;
      if (txtValue.toUpperCase().indexOf(filter) > -1) {
        tr[i].style.display = "";
      } else {
        tr[i].style.display = "none";
      }
    }       
  }
}
  

    // filter dropdown
    function filterTable() {
        // Variables
        let dropdown, table, rows, cells, list, filter;
        dropdown = document.getElementById("listDropdown");
        table = document.getElementById("myTable");
        rows = table.getElementsByTagName("tr");
        filter = dropdown.value;

     
        for (let row of rows) { 
            cells = row.getElementsByTagName("td");
            list = cells[5] || null;

            if (filter === "All Forms" || !list || (filter === list.textContent)) {
                row.style.display = ""; 
            }
            else {
                row.style.display = "none"; 
            }
        }
    }

    // download table
    
     function tableToCSV() {


var csv_data = [];


var rows = document.getElementsByTagName('tr');
for (var i = 0; i < rows.length; i++) {

    var cols = rows[i].querySelectorAll('td,th');

    var csvrow = [];
    for (var j = 0; j < cols.length; j++) {

        csvrow.push(cols[j].innerHTML);
    }

 
    csv_data.push(csvrow.join(","));
}

csv_data = csv_data.join('\n');

downloadCSVFile(csv_data);

}

function downloadCSVFile(csv_data) {



CSVFile = new Blob([csv_data], {
    type: "text/csv"
    
});


var temp_link = document.createElement('a');

temp_link.download = "GfG.csv";
var url = window.URL.createObjectURL(CSVFile);
temp_link.href = url;

temp_link.style.display = "none";
document.body.appendChild(temp_link);


temp_link.click();
document.body.removeChild(temp_link);
}










</script>

</html>